{% extends "booking/base_bs.html" %}
{% block head_title%}Daily attendance list{% endblock %}
{% load widget_tweaks %}
{% load booking_tags %}
{% block content %}
<form method="get">
    <div class="card card-body bg-light">
        <h4>Filter</h4>
        <div class="row">
            <div class="form-group col-sm-4 col-md-6">
            {{ attendance_filter.form.book__event.label_tag }}
            {% render_field attendance_filter.form.book__event class="form-control" %}
            </div>
            <div class="form-group col-sm-2 col-md-2">
            {{ attendance_filter.form.attendance_date.label_tag }}
            {% render_field attendance_filter.form.attendance_date class="datepicker form-control" %}
            </div>
        </div>
        <button type="submit" name="filter" class="btn btn-primary">
        <i class="fas fa-search"></i> Search
        </button>
    </div>
</form>
<form action="{% url 'teacher_attendance' %}" method="POST">{% csrf_token %}
    <div class="table-responsive">
    <table class="table table-hover table-borderless">
        <caption>Todays date: {{date_today}}</caption>
        <thead>
            <th scope="col">Name</th>
            <th scope="col">Attendance</th>
            <th scope="col">Switch</th>
            <th scope="col">Id</th>
            <th scope="col">Event</th>
            <th scope="col">Status</th>
        </thead>
        <tbody>
            {% for obj in attendance_list %}
            <tr>
                <th scope="row">{{obj.book.user.get_full_name}}</td>
                <td>{% get_attendance_check obj 'get_check' filtered_date %}</td>
                <input type="hidden" name="filtered_date" value="{{filtered_date|date:"Y-m-d"}}">
                <td><input type="checkbox" name="check" value="{{obj.id}} {% get_attendance_num obj 'get_num' filtered_date %}"></td>
                <td>{{obj.book.id}}</td>
                <td>{{obj.book.event}}</td>
                <td>{{obj.book.invoice.get_status_display}}</td>
                <input type="hidden" name="filtered_event" value="{{obj.book.event.id}}">
            </tr>
            {% endfor%}
        </tbody>
    </table>
    </div>
        <button type="submit" name="update" class="btn btn-warning">
        <i class="fas fa-edit"></i> Check
        </button>
        <a class="btn btn-danger" href={% url "teacher_booking_create" %}?book__event={{request.GET.book__event}}&attendance_date={{request.GET.attendance_date}}><i class="fas fa-plus"></i> Add Book </a>
</form>
{% endblock %}
